(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[435],{2884:function(e,t,r){Promise.resolve().then(r.bind(r,6962))},9174:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var s=r(7437);r(2265);var n=r(535),a=r(3448);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...n}=e;return(0,s.jsx)("div",{className:(0,a.cn)(i({variant:r}),t),...n})}},2381:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var s=r(7437),n=r(2265),a=r(7053),i=r(535),l=r(3448);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:o=!1,...c}=e,u=o?a.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(d({variant:n,size:i,className:r})),ref:t,...c})});o.displayName="Button"},9820:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return c},ll:function(){return d}});var s=r(7437),n=r(2265),a=r(3448);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,"data-slot":"card",className:(0,a.cn)("rounded-xl border bg-card text-card-foreground","shadow-[0_2px_8px_rgba(0,0,0,0.08)]",r),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,"data-slot":"card-header",className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});d.displayName="CardTitle";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});o.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return a},o:function(){return i}});var s=r(1994),n=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}function i(e){return e?new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}},6962:function(e,t,r){"use strict";r.d(t,{DispatchMonitoringPage:function(){return j}});var s=r(7437),n=r(2265),a=r(9820),i=r(9174),l=r(8280);let d="http://localhost",o="anon";if(!d||!o)throw Error("Missing Supabase environment variables");let c=(0,l.eI)(d,o),u={async submitRows(e,t){let{data:r,error:s}=await c.from("dispatch_reports").insert(e.map(e=>({...e,submitted_by_ops_id:t}))).select();return s?{error:s.message}:{data:{created_count:r.length}}},async getDispatches(e){let t=c.from("dispatch_reports").select("*",{count:"exact"});e.status&&(t=t.eq("status",e.status)),e.region&&(t=t.eq("region",e.region)),e.startDate&&(t=t.gte("created_at",e.startDate)),e.endDate&&(t=t.lte("created_at",e.endDate)),e.limit&&(t=t.limit(e.limit)),e.offset&&(t=t.range(e.offset,e.offset+(e.limit||10)-1));let{data:r,error:s,count:n}=await t.order("created_at",{ascending:!1});return s?{error:s.message}:{data:{rows:r,total:n}}},async verifyRows(e){let{data:t,error:r}=await c.rpc("verify_dispatch_rows",e);return r?{error:r.message}:{data:t}}};var f=r(3448),m=r(5302),x=r(1723),g=r(2252),h=r(4794),p=r(340),b=r(7168),v=r(2381);function j(){let[e,t]=(0,n.useState)([]),[r,l]=(0,n.useState)(!0),[d,o]=(0,n.useState)({total:0,pending:0,ongoing:0,completed:0});(0,n.useEffect)(()=>{c();let e=setInterval(c,3e4);return()=>clearInterval(e)},[]);let c=async()=>{l(!0);let e=await u.getDispatches({limit:20});if(l(!1),e.data){let r=e.data.rows||[];t(r),o({total:r.length,pending:r.filter(e=>"Pending"===e.status).length,ongoing:r.filter(e=>"Ongoing"===e.status).length,completed:r.filter(e=>"Completed"===e.status||"Verified"===e.status).length})}},j=e=>{switch(e){case"Completed":case"Verified":return(0,s.jsx)(m.Z,{className:"h-4 w-4 text-green-500"});case"Ongoing":return(0,s.jsx)(x.Z,{className:"h-4 w-4 text-yellow-500"});default:return(0,s.jsx)(g.Z,{className:"h-4 w-4 text-blue-500"})}},N=e=>{switch(e){case"Completed":case"Verified":return"bg-green-100 text-green-700 border-green-200";case"Ongoing":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-blue-100 text-blue-700 border-blue-200"}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,s.jsxs)(a.Zb,{children:[(0,s.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,s.jsx)(a.ll,{className:"text-sm font-medium",children:"Total Dispatches"}),(0,s.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(a.aY,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:d.total})})]}),(0,s.jsxs)(a.Zb,{children:[(0,s.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,s.jsx)(a.ll,{className:"text-sm font-medium",children:"Pending"}),(0,s.jsx)(g.Z,{className:"h-4 w-4 text-blue-500"})]}),(0,s.jsx)(a.aY,{children:(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:d.pending})})]}),(0,s.jsxs)(a.Zb,{children:[(0,s.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,s.jsx)(a.ll,{className:"text-sm font-medium",children:"Ongoing"}),(0,s.jsx)(x.Z,{className:"h-4 w-4 text-yellow-500"})]}),(0,s.jsx)(a.aY,{children:(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:d.ongoing})})]}),(0,s.jsxs)(a.Zb,{children:[(0,s.jsxs)(a.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,s.jsx)(a.ll,{className:"text-sm font-medium",children:"Completed"}),(0,s.jsx)(m.Z,{className:"h-4 w-4 text-green-500"})]}),(0,s.jsx)(a.aY,{children:(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:d.completed})})]})]}),(0,s.jsxs)(a.Zb,{children:[(0,s.jsx)(a.Ol,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(a.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(p.Z,{className:"h-5 w-5"}),"Live Dispatch Feed"]}),(0,s.jsx)(a.SZ,{children:"Real-time dispatch monitoring (auto-refreshes every 30s)"})]}),(0,s.jsxs)(v.z,{variant:"outline",size:"sm",onClick:c,disabled:r,children:[(0,s.jsx)(b.Z,{className:"h-4 w-4 mr-2 ".concat(r?"animate-spin":"")}),"Refresh"]})]})}),(0,s.jsx)(a.aY,{children:r&&0===e.length?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)(b.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===e.length?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No dispatches found"}):(0,s.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[j(e.status),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.cluster_name}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.station_name," â€¢ ",e.processor_name]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"text-right text-sm",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:e.plate_number}),(0,s.jsx)("div",{className:"text-xs",children:(0,f.o)(e.actual_docked_time)})]}),(0,s.jsx)(i.C,{className:N(e.status),children:e.status})]})]},e.dispatch_id))})})]})]})}}},function(e){e.O(0,[554,29,980,971,117,744],function(){return e(e.s=2884)}),_N_E=e.O()}]);