"use strict";(()=>{var e={};e.id=8692,e.ids=[8692],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},85807:e=>{e.exports=require("module")},55315:e=>{e.exports=require("path")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},6162:e=>{e.exports=require("worker_threads")},8678:e=>{e.exports=import("pg")},92761:e=>{e.exports=require("node:async_hooks")},6005:e=>{e.exports=require("node:crypto")},65714:e=>{e.exports=require("node:diagnostics_channel")},15673:e=>{e.exports=require("node:events")},70612:e=>{e.exports=require("node:os")},49411:e=>{e.exports=require("node:path")},71217:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>p,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>x,staticGenerationAsyncStorage:()=>c});var o=r(49303),n=r(88716),i=r(60670),a=r(16597),u=e([a]);a=(u.then?(await u)():u)[0];let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/hubs/[id]/route",pathname:"/api/hubs/[id]",filename:"route",bundlePath:"app/api/hubs/[id]/route"},resolvedPagePath:"C:\\Users\\phlspxuser\\Documents\\Mrkcde\\Ongoing\\soc5-internalTool\\src\\app\\api\\hubs\\[id]\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:c,serverHooks:x}=d,m="/api/hubs/[id]/route";function p(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:c})}s()}catch(e){s(e)}})},16597:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{DELETE:()=>m,PATCH:()=>x});var o=r(87070),n=r(75748),i=r(95456),a=r(11958),u=r(76097),p=r(84235),d=r(21067),l=e([n,i,u]);[n,i,u]=l.then?(await l)():l;let c=d.Ry({cluster_name:d.Z_().trim().min(1).optional(),hub_name:d.Z_().trim().min(1).optional(),region:d.Z_().trim().min(1).optional(),dock_number:d.Z_().trim().min(1).optional(),active:d.O7().optional()}).strict().refine(e=>Object.keys(e).length>0,{message:"hub data is required"}),x=(0,a.g)("/api/hubs/[id]",async(e,{params:t})=>{let r=await (0,i.Gg)();if(!r)return o.NextResponse.json({error:"Unauthorized"},{status:401});let s=await (0,u.l)(r.sessionId);if(!s.allowed)return o.NextResponse.json({error:"Too many requests"},{status:429,headers:{"Retry-After":String(s.retryAfterSeconds)}});let a=await (0,p.Y)(e,c);if(a.errorResponse)return a.errorResponse;let d=Object.entries(a.data),l=d.map(([e],t)=>`"${e}" = $${t+1}`).join(", "),x=d.map(([,e])=>e);x.push(t.id);let m=await (0,n.I)(`UPDATE outbound_map
       SET ${l}
       WHERE id = $${x.length}
       RETURNING *`,x);return 0===m.rows.length?o.NextResponse.json({error:"Hub not found"},{status:404}):o.NextResponse.json(m.rows[0])}),m=(0,a.g)("/api/hubs/[id]",async(e,{params:t})=>{if(!await (0,i.Gg)())return o.NextResponse.json({error:"Unauthorized"},{status:401});let r=await (0,n.I)(`UPDATE outbound_map
       SET active = false
       WHERE id = $1
       RETURNING *`,[t.id]);return 0===r.rows.length?o.NextResponse.json({error:"Hub not found"},{status:404}):o.NextResponse.json(r.rows[0])});s()}catch(e){s(e)}})},76097:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.d(t,{l:()=>a});var o=r(75748),n=e([o]);function i(e,t){if(!e)return t;let r=Number(e);return!Number.isFinite(r)||r<=0?t:r}o=(n.then?(await n)():n)[0];let u=i(process.env.RATE_LIMIT_WINDOW_MS,6e4),p=i(process.env.RATE_LIMIT_MAX_REQUESTS,60);async function a(e,t){let r=t?.windowMs??u,s=t?.limit??p,n=`${Math.max(1,Math.floor(r/1e3))} seconds`,i=(await (0,o.I)(`INSERT INTO session_rate_limits (session_id, count, expires_at)
     VALUES ($1, 1, NOW() + $2::interval)
     ON CONFLICT (session_id)
     DO UPDATE SET
       count = CASE WHEN session_rate_limits.expires_at < NOW() THEN 1 ELSE session_rate_limits.count + 1 END,
       expires_at = CASE WHEN session_rate_limits.expires_at < NOW() THEN NOW() + $2::interval ELSE session_rate_limits.expires_at END
     RETURNING count, expires_at`,[e,n])).rows[0];if((i?.count??s+1)>s){let e=i?.expires_at?new Date(i.expires_at).getTime():Date.now()+r,t=Math.max(1,Math.ceil((e-Date.now())/1e3));return{allowed:!1,retryAfterSeconds:t,limit:s}}return{allowed:!0,retryAfterSeconds:0,limit:s}}s()}catch(e){s(e)}})},84235:(e,t,r)=>{r.d(t,{Y:()=>o});var s=r(87070);async function o(e,t){let r=await e.json().catch(()=>void 0),o=t.safeParse(r??{});if(!o.success){let e=o.error.flatten(),t=o.error.errors[0]?.message||"Invalid request";return{errorResponse:s.NextResponse.json({error:t,details:e},{status:400})}}return{data:o.data}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,7936,1067,5456],()=>r(71217));module.exports=s})();