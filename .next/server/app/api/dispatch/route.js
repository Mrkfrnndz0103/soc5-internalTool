"use strict";(()=>{var t={};t.id=176,t.ids=[176],t.modules={20399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:t=>{t.exports=import("pg")},27673:(t,e,r)=>{r.a(t,async(t,a)=>{try{r.r(e),r.d(e,{originalPathname:()=>g,patchFetch:()=>u,requestAsyncStorage:()=>h,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>l});var s=r(49303),o=r(88716),n=r(60670),i=r(41611),p=t([i]);i=(p.then?(await p)():p)[0];let c=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dispatch/route",pathname:"/api/dispatch",filename:"route",bundlePath:"app/api/dispatch/route"},resolvedPagePath:"C:\\Users\\phlspxuser\\Documents\\Mrkcde\\Ongoing\\soc5-internalTool\\src\\app\\api\\dispatch\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:h,staticGenerationAsyncStorage:l,serverHooks:d}=c,g="/api/dispatch/route";function u(){return(0,n.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:l})}a()}catch(t){a(t)}})},41611:(t,e,r)=>{r.a(t,async(t,a)=>{try{r.r(e),r.d(e,{GET:()=>i});var s=r(87070),o=r(75748),n=t([o]);async function i(t){let{searchParams:e}=new URL(t.url),r=e.get("status"),a=e.get("region"),n=e.get("startDate"),i=e.get("endDate"),p=Number(e.get("limit")||"10"),u=Number(e.get("offset")||"0"),c=[],h=[];r&&(h.push(r),c.push(`status = $${h.length}`)),a&&(h.push(a),c.push(`region = $${h.length}`)),n&&(h.push(n),c.push(`created_at >= $${h.length}`)),i&&(h.push(i),c.push(`created_at <= $${h.length}`));let l=c.length?`WHERE ${c.join(" AND ")}`:"",d=await (0,o.I)(`SELECT COUNT(*)::int AS total
     FROM dispatch_reports
     ${l}`,h),g=await (0,o.I)(`SELECT *
     FROM dispatch_reports
     ${l}
     ORDER BY created_at DESC
     LIMIT $${h.length+1}
     OFFSET $${h.length+2}`,[...h,p,u]);return s.NextResponse.json({rows:g.rows,total:d.rows[0]?.total||0})}o=(n.then?(await n)():n)[0],a()}catch(t){a(t)}})},75748:(t,e,r)=>{r.a(t,async(t,a)=>{try{r.d(e,{I:()=>n});var s=r(8678),o=t([s]);s=(o.then?(await o)():o)[0];let i=process.env.DATABASE_URL;if(!i)throw Error("DATABASE_URL is not set");let p="true"===process.env.DATABASE_SSL,u=globalThis.__pgPool||new s.Pool({connectionString:i,ssl:p?{rejectUnauthorized:!1}:void 0});async function n(t,e){return u.query(t,e)}globalThis.__pgPool||(globalThis.__pgPool=u),a()}catch(t){a(t)}})}};var e=require("../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),a=e.X(0,[9276,5972],()=>r(27673));module.exports=a})();