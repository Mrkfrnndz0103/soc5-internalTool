"use strict";(()=>{var e={};e.id=6015,e.ids=[6015],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},86802:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>p,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>_,staticGenerationAsyncStorage:()=>d});var s=r(49303),o=r(88716),n=r(60670),i=r(25780),u=e([i]);i=(u.then?(await u)():u)[0];let c=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dispatch/submit/route",pathname:"/api/dispatch/submit",filename:"route",bundlePath:"app/api/dispatch/submit/route"},resolvedPagePath:"C:\\Users\\phlspxuser\\Documents\\Mrkcde\\Ongoing\\soc5-internalTool\\src\\app\\api\\dispatch\\submit\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:_}=c,m="/api/dispatch/submit/route";function p(){return(0,n.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:d})}a()}catch(e){a(e)}})},25780:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{POST:()=>u});var s=r(87070),o=r(75748),n=e([o]);function i(e,t){for(let r of t)if(void 0!==e[r]&&null!==e[r]&&""!==e[r])return e[r];return null}async function u(e){let t=await e.json().catch(()=>({})),r=Array.isArray(t?.rows)?t.rows:[],a=t?.submitted_by_ops_id;if(!a)return s.NextResponse.json({error:"submitted_by_ops_id is required"},{status:400});if(0===r.length)return s.NextResponse.json({error:"rows are required"},{status:400});for(let e of r){let t=i(e,["cluster_name","clusterName"]),r=i(e,["station_name","station"]),s=i(e,["region"]),n=i(e,["status"])||"Pending",u=i(e,["lh_trip_number","lh_trip","lHTripNumber"]),p=i(e,["actual_docked_time","actualDockedTime"]),c=i(e,["actual_depart_time","actualDepartTime"]),l=i(e,["processor_name","processorName"]),d=i(e,["plate_number","plateNumber"]);await (0,o.I)(`INSERT INTO dispatch_reports
       (cluster_name, station_name, region, status, lh_trip_number, actual_docked_time, actual_depart_time, processor_name, plate_number, submitted_by_ops_id, created_at, status_updated_at)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, NOW(), NOW())`,[t,r,s,n,u,p?new Date(p):null,c?new Date(c):null,l,d,a])}return s.NextResponse.json({created_count:r.length})}o=(n.then?(await n)():n)[0],a()}catch(e){a(e)}})},75748:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{I:()=>n});var s=r(8678),o=e([s]);s=(o.then?(await o)():o)[0];let i=process.env.DATABASE_URL;if(!i)throw Error("DATABASE_URL is not set");let u="true"===process.env.DATABASE_SSL,p=globalThis.__pgPool||new s.Pool({connectionString:i,ssl:u?{rejectUnauthorized:!1}:void 0});async function n(e,t){return p.query(e,t)}globalThis.__pgPool||(globalThis.__pgPool=p),a()}catch(e){a(e)}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972],()=>r(86802));module.exports=a})();